# run-order-summary-job.sh

注文サマリーをジョブとして実行し、結果を表示するスクリプトです。

## 使い方

```bash
./scripts/run-order-summary-job.sh <開始日> <終了日>
```

## 引数

| 引数 | 必須 | 説明 | 形式 |
|------|------|------|------|
| 開始日 | ○ | 抽出期間の開始日 | YYYY-MM-DD |
| 終了日 | ○ | 抽出期間の終了日 | YYYY-MM-DD |

## 使用例

```bash
# 2024年全体
./scripts/run-order-summary-job.sh 2024-01-01 2024-12-31

# 2024年上半期
./scripts/run-order-summary-job.sh 2024-01-01 2024-06-30
```

## 動作

1. 引数をチェック（2つの引数が必須）
2. プロジェクトルートの `.env` ファイルを読み込む
3. 環境変数をチェック
4. ストアドプロシージャ `insert_order_summary_job` を実行してジョブIDを取得
5. ジョブのステータスを表示
6. ジョブの結果（CSV）を表示

## 前提条件

- `.env` ファイルが設定済みであること
- PostgreSQL サーバーが起動していること
- `setup-database.sh` でテーブル・ストアドプロシージャ・テストデータが作成済みであること

## 必要な環境変数

| 変数名 | 必須 | デフォルト値 | 説明 |
|--------|------|-------------|------|
| POSTGRES_USER | ○ | - | データベースユーザー名 |
| POSTGRES_PASSWORD | ○ | - | データベースパスワード |
| POSTGRES_DB | ○ | - | データベース名 |
| POSTGRES_PORT | - | 5432 | ポート番号 |
| POSTGRES_HOST | - | localhost | ホスト名 |

## 出力例

```
ジョブを実行中... (期間: 2024-01-01 〜 2024-12-31)
ジョブID: 1

=== ジョブのステータス ===
 id | status
----+-----------
  1 | completed

=== ジョブの結果（CSV） ===
注文ID,注文日,ステータス,地域名,会社名,部署名,担当者名,明細数,合計金額
...
```

## 関連スクリプト

- [download-job-result.md](download-job-result.md) - ジョブの結果をファイルに保存
